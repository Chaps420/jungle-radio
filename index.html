<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Jungle Radio Request Line</title>
  <style>
    body { font-family: sans-serif; background: #111; color: #fff; padding: 2rem; }
    input, button { margin: 0.5rem 0; padding: 0.5rem; }
    .song { margin-bottom: 1rem; border-bottom: 1px solid #444; padding-bottom: 0.5rem; }
    .admin-btn { background: red; color: white; border: none; padding: 0.3rem 0.6rem; cursor: pointer; }
  </style>
</head>
<body>
  <h1>ðŸŽ¶ Jungle Radio Request Line</h1>

  <div>
    <input id="nameInput" placeholder="Your name">
    <input id="songInput" placeholder="YouTube or song link">
    <button onclick="submitRequest()">Submit</button>
  </div>

  <div>
    <button onclick="toggleAdmin()">Admin Mode</button>
    <input id="adminPassword" placeholder="Password" type="password" style="display:none;" />
  </div>

  <h2>Current Requests</h2>
  <div id="songList">Loading...</div>

  <script>
    const API_URL = 'https://jungle-radio-api.onrender.com/api/songs'; // UPDATE THIS TO YOUR RENDER URL
    let isAdmin = false;
    let adminPass = '';

    async function fetchSongs() {
      const res = await fetch(API_URL);
      const data = await res.json();
      document.getElementById('songList').innerHTML = data.map(song => `
        <div class="song">
          <strong>${song.name}</strong>: ${song.song}
          ${isAdmin ? `<button class="admin-btn" onclick="deleteSong('${song.id}')">Delete</button>` : ''}
        </div>
      `).join('');
    }

    async function submitRequest() {
      const name = document.getElementById('nameInput').value;
      const song = document.getElementById('songInput').value;
      await fetch(API_URL, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ name, song })
      });
      document.getElementById('nameInput').value = '';
      document.getElementById('songInput').value = '';
      fetchSongs();
    }

    async function deleteSong(id) {
      await fetch(`${API_URL}/${id}`, {
        method: 'DELETE',
        headers: {
          'Content-Type': 'application/json',
          'Authorization': `Bearer ${adminPass}`
        }
      });
      fetchSongs();
    }

    function toggleAdmin() {
      const input = document.getElementById('adminPassword');
      if (input.style.display === 'none') {
        input.style.display = 'inline';
        input.addEventListener('change', () => {
          adminPass = input.value;
          isAdmin = true;
          fetchSongs();
        });
      } else {
        isAdmin = false;
        adminPass = '';
        input.style.display = 'none';
        fetchSongs();
      }
    }

    fetchSongs();
  </script>
</body>
</html>
